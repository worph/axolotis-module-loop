var De=Object.defineProperty;var Ge=Object.getOwnPropertyDescriptor;var b=(g,o,s,u)=>{for(var m=u>1?void 0:u?Ge(o,s):o,v=g.length-1,L;v>=0;v--)(L=g[v])&&(m=(u?L(o,s,m):L(m))||m);return u&&m&&De(o,s,m),m},M=(g,o)=>(s,u)=>o(s,u,g);var oe;(function(g){(function(o){var s=typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),u=m(g);typeof s.Reflect>"u"?s.Reflect=g:u=m(s.Reflect,u),o(u);function m(v,L){return function(w,T){typeof v[w]!="function"&&Object.defineProperty(v,w,{configurable:!0,writable:!0,value:T}),L&&L(w,T)}}})(function(o){var s=Object.prototype.hasOwnProperty,u=typeof Symbol=="function",m=u&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",v=u&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",L=typeof Object.create=="function",w={__proto__:[]}instanceof Array,T=!L&&!w,S={create:L?function(){return B(Object.create(null))}:w?function(){return B({__proto__:null})}:function(){return B({})},has:T?function(e,t){return s.call(e,t)}:function(e,t){return t in e},get:T?function(e,t){return s.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},E=Object.getPrototypeOf(Function),O=typeof process=="object"&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL==="true",N=!O&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Fe(),pe=!O&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Re(),me=!O&&typeof WeakMap=="function"?WeakMap:Ue(),G=new me;function he(e,t,r,n){if(h(r)){if(!ee(e))throw new TypeError;if(!te(t))throw new TypeError;return Te(e,t)}else{if(!ee(e))throw new TypeError;if(!d(t))throw new TypeError;if(!d(n)&&!h(n)&&!j(n))throw new TypeError;return j(n)&&(n=void 0),r=_(r),ke(e,t,r,n)}}o("decorate",he);function de(e,t){function r(n,a){if(!d(n))throw new TypeError;if(!h(a)&&!Ne(a))throw new TypeError;z(e,t,n,a)}return r}o("metadata",de);function ve(e,t,r,n){if(!d(r))throw new TypeError;return h(n)||(n=_(n)),z(e,t,r,n)}o("defineMetadata",ve);function ye(e,t,r){if(!d(t))throw new TypeError;return h(r)||(r=_(r)),Y(e,t,r)}o("hasMetadata",ye);function ge(e,t,r){if(!d(t))throw new TypeError;return h(r)||(r=_(r)),W(e,t,r)}o("hasOwnMetadata",ge);function Le(e,t,r){if(!d(t))throw new TypeError;return h(r)||(r=_(r)),Z(e,t,r)}o("getMetadata",Le);function be(e,t,r){if(!d(t))throw new TypeError;return h(r)||(r=_(r)),$(e,t,r)}o("getOwnMetadata",be);function we(e,t){if(!d(e))throw new TypeError;return h(t)||(t=_(t)),J(e,t)}o("getMetadataKeys",we);function _e(e,t){if(!d(e))throw new TypeError;return h(t)||(t=_(t)),Q(e,t)}o("getOwnMetadataKeys",_e);function Me(e,t,r){if(!d(t))throw new TypeError;h(r)||(r=_(r));var n=D(t,r,!1);if(h(n)||!n.delete(e))return!1;if(n.size>0)return!0;var a=G.get(t);return a.delete(r),a.size>0||G.delete(t),!0}o("deleteMetadata",Me);function Te(e,t){for(var r=e.length-1;r>=0;--r){var n=e[r],a=n(t);if(!h(a)&&!j(a)){if(!te(a))throw new TypeError;t=a}}return t}function ke(e,t,r,n){for(var a=e.length-1;a>=0;--a){var y=e[a],f=y(t,r,n);if(!h(f)&&!j(f)){if(!d(f))throw new TypeError;n=f}}return n}function D(e,t,r){var n=G.get(e);if(h(n)){if(!r)return;n=new N,G.set(e,n)}var a=n.get(t);if(h(a)){if(!r)return;a=new N,n.set(t,a)}return a}function Y(e,t,r){var n=W(e,t,r);if(n)return!0;var a=V(t);return j(a)?!1:Y(e,a,r)}function W(e,t,r){var n=D(t,r,!1);return h(n)?!1:Ee(n.has(e))}function Z(e,t,r){var n=W(e,t,r);if(n)return $(e,t,r);var a=V(t);if(!j(a))return Z(e,a,r)}function $(e,t,r){var n=D(t,r,!1);if(!h(n))return n.get(e)}function z(e,t,r,n){var a=D(r,n,!0);a.set(e,t)}function J(e,t){var r=Q(e,t),n=V(e);if(n===null)return r;var a=J(n,t);if(a.length<=0)return r;if(r.length<=0)return a;for(var y=new pe,f=[],c=0,i=r;c<i.length;c++){var l=i[c],p=y.has(l);p||(y.add(l),f.push(l))}for(var k=0,ne=a;k<ne.length;k++){var l=ne[k],p=y.has(l);p||(y.add(l),f.push(l))}return f}function Q(e,t){var r=[],n=D(e,t,!1);if(h(n))return r;for(var a=n.keys(),y=je(a),f=0;;){var c=Pe(y);if(!c)return r.length=f,r;var i=Ce(c);try{r[f]=i}catch(l){try{Ae(y)}finally{throw l}}f++}}function K(e){if(e===null)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return e===null?1:6;default:return 6}}function h(e){return e===void 0}function j(e){return e===null}function Ie(e){return typeof e=="symbol"}function d(e){return typeof e=="object"?e!==null:typeof e=="function"}function xe(e,t){switch(K(e)){case 0:return e;case 1:return e;case 2:return e;case 3:return e;case 4:return e;case 5:return e}var r=t===3?"string":t===5?"number":"default",n=re(e,m);if(n!==void 0){var a=n.call(e,r);if(d(a))throw new TypeError;return a}return Se(e,r==="default"?"number":r)}function Se(e,t){if(t==="string"){var r=e.toString;if(C(r)){var n=r.call(e);if(!d(n))return n}var a=e.valueOf;if(C(a)){var n=a.call(e);if(!d(n))return n}}else{var a=e.valueOf;if(C(a)){var n=a.call(e);if(!d(n))return n}var y=e.toString;if(C(y)){var n=y.call(e);if(!d(n))return n}}throw new TypeError}function Ee(e){return!!e}function Oe(e){return""+e}function _(e){var t=xe(e,3);return Ie(t)?t:Oe(t)}function ee(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:Object.prototype.toString.call(e)==="[object Array]"}function C(e){return typeof e=="function"}function te(e){return typeof e=="function"}function Ne(e){switch(K(e)){case 3:return!0;case 4:return!0;default:return!1}}function re(e,t){var r=e[t];if(r!=null){if(!C(r))throw new TypeError;return r}}function je(e){var t=re(e,v);if(!C(t))throw new TypeError;var r=t.call(e);if(!d(r))throw new TypeError;return r}function Ce(e){return e.value}function Pe(e){var t=e.next();return t.done?!1:t}function Ae(e){var t=e.return;t&&t.call(e)}function V(e){var t=Object.getPrototypeOf(e);if(typeof e!="function"||e===E||t!==E)return t;var r=e.prototype,n=r&&Object.getPrototypeOf(r);if(n==null||n===Object.prototype)return t;var a=n.constructor;return typeof a!="function"||a===e?t:a}function Fe(){var e={},t=[],r=function(){function f(c,i,l){this._index=0,this._keys=c,this._values=i,this._selector=l}return f.prototype["@@iterator"]=function(){return this},f.prototype[v]=function(){return this},f.prototype.next=function(){var c=this._index;if(c>=0&&c<this._keys.length){var i=this._selector(this._keys[c],this._values[c]);return c+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:i,done:!1}}return{value:void 0,done:!0}},f.prototype.throw=function(c){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),c},f.prototype.return=function(c){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:c,done:!0}},f}();return function(){function f(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(f.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),f.prototype.has=function(c){return this._find(c,!1)>=0},f.prototype.get=function(c){var i=this._find(c,!1);return i>=0?this._values[i]:void 0},f.prototype.set=function(c,i){var l=this._find(c,!0);return this._values[l]=i,this},f.prototype.delete=function(c){var i=this._find(c,!1);if(i>=0){for(var l=this._keys.length,p=i+1;p<l;p++)this._keys[p-1]=this._keys[p],this._values[p-1]=this._values[p];return this._keys.length--,this._values.length--,c===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},f.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},f.prototype.keys=function(){return new r(this._keys,this._values,n)},f.prototype.values=function(){return new r(this._keys,this._values,a)},f.prototype.entries=function(){return new r(this._keys,this._values,y)},f.prototype["@@iterator"]=function(){return this.entries()},f.prototype[v]=function(){return this.entries()},f.prototype._find=function(c,i){return this._cacheKey!==c&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=c)),this._cacheIndex<0&&i&&(this._cacheIndex=this._keys.length,this._keys.push(c),this._values.push(void 0)),this._cacheIndex},f}();function n(f,c){return f}function a(f,c){return c}function y(f,c){return[f,c]}}function Re(){return function(){function e(){this._map=new N}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this._map.has(t)},e.prototype.add=function(t){return this._map.set(t,t),this},e.prototype.delete=function(t){return this._map.delete(t)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[v]=function(){return this.keys()},e}()}function Ue(){var e=16,t=S.create(),r=n();return function(){function i(){this._key=n()}return i.prototype.has=function(l){var p=a(l,!1);return p!==void 0?S.has(p,this._key):!1},i.prototype.get=function(l){var p=a(l,!1);return p!==void 0?S.get(p,this._key):void 0},i.prototype.set=function(l,p){var k=a(l,!0);return k[this._key]=p,this},i.prototype.delete=function(l){var p=a(l,!1);return p!==void 0?delete p[this._key]:!1},i.prototype.clear=function(){this._key=n()},i}();function n(){var i;do i="@@WeakMap@@"+c();while(S.has(t,i));return t[i]=!0,i}function a(i,l){if(!s.call(i,r)){if(!l)return;Object.defineProperty(i,r,{value:S.create()})}return i[r]}function y(i,l){for(var p=0;p<l;++p)i[p]=Math.random()*255|0;return i}function f(i){return typeof Uint8Array=="function"?typeof crypto<"u"?crypto.getRandomValues(new Uint8Array(i)):typeof msCrypto<"u"?msCrypto.getRandomValues(new Uint8Array(i)):y(new Uint8Array(i),i):y(new Array(i),i)}function c(){var i=f(e);i[6]=i[6]&79|64,i[8]=i[8]&191|128;for(var l="",p=0;p<e;++p){var k=i[p];(p===4||p===6||p===8)&&(l+="-"),k<16&&(l+="0"),l+=k.toString(16).toLowerCase()}return l}}function B(e){return e.__=void 0,delete e.__,e}})})(oe||(oe={}));import{ContainerModule as Xe}from"inversify";var I=Symbol.for("FrameLoopManagerName"),ae=Symbol.for("AnimationFrameLoopFactoryName"),ie=Symbol.for("SetIntervalLoopFactoryName"),se=Symbol.for("SetTimeoutLoopFactoryName"),x=Symbol.for("LoopTimeLoggerName");import{inject as fe,injectable as We}from"inversify";var q=class{constructor(o,s){this.callback=o;this.timeLogger=s}enable=!1;start(){if(this.enable)throw new Error("Loop already started");this.enable=!0;let o=0,s=u=>{let m=u-o;o=u,this.enable&&requestAnimationFrame(s),this.timeLogger.monitoringStart(),this.callback(m),this.timeLogger.monitoringEnd()};requestAnimationFrame(s)}stop(){this.enable=!1}},P=class{constructor(o,s){this.timeLogger=o;this.frameLoop=s}create(o,s){let u=new q(s,this.timeLogger.getTimeLogger(o));return this.frameLoop.addLoop(o,u),{loop:u,remover:()=>{this.frameLoop.removeLoop(o)}}}};P=b([We(),M(0,fe(x)),M(1,fe(I))],P);import{injectable as Ve}from"inversify";var A=class{started=!1;constructor(){}loops=new Map;start(){this.started=!0;for(let[o,s]of this.loops)s.start()}stop(){this.started=!1;for(let[o,s]of this.loops)s.stop()}addLoop(o,s){if(this.loops.has(o))throw new Error("Loop name already used :"+o);return this.started&&s.start(),this.loops.set(o,s),()=>{this.removeLoop(o)}}removeLoop(o){this.loops.get(o).stop(),this.loops.delete(o)}};A=b([Ve()],A);import{inject as ue,injectable as Be}from"inversify";var H=class{constructor(o,s,u){this.callback=o;this.timeLogger=s;this.intervalMs=u}intervalId=null;start(){if(this.intervalId)throw new Error("Loop already started");let o=0,s=u=>{let m=u-o;o=u,this.timeLogger.monitoringStart(),this.callback(m),this.timeLogger.monitoringEnd()};this.intervalId=setInterval(s,this.intervalMs)}stop(){this.intervalId&&(this.intervalId=null,clearInterval(this.intervalId))}},F=class{constructor(o,s){this.timeLogger=o;this.frameLoop=s}create(o,s,u=0){let m=new H(s,this.timeLogger.getTimeLogger(o),u);return this.frameLoop.addLoop(o,m),{loop:m,remover:()=>{this.frameLoop.removeLoop(o)}}}};F=b([Be(),M(0,ue(x)),M(1,ue(I))],F);import{inject as ce,injectable as qe}from"inversify";var X=class{constructor(o,s,u){this.callback=o;this.timeLogger=s;this.timeoutMs=u}enable=!1;start(){if(this.enable)throw new Error("Loop already started");this.enable=!0;let o=performance.now(),s=()=>{let u=performance.now(),m=u-o;o=u,this.timeLogger.monitoringStart(),this.callback(m),this.timeLogger.monitoringEnd();let L=performance.now()-u;this.enable&&setTimeout(s,L>this.timeoutMs?0:this.timeoutMs-L)};s()}stop(){this.enable=!1}},R=class{constructor(o,s){this.timeLogger=o;this.frameLoop=s}create(o,s,u=0){let m=new X(s,this.timeLogger.getTimeLogger(o),u);return this.frameLoop.addLoop(o,m),{loop:m,remover:()=>{this.frameLoop.removeLoop(o)}}}};R=b([qe(),M(0,ce(x)),M(1,ce(I))],R);import{injectable as He}from"inversify";var lt="-",U=class{getTimeLogger(o){o=o.replace(/-[^-]*$/,"");let s=0,u=0,m=0,v=0,L=0,w=0,T=0,S=this.callbacks;return{monitoringStart:()=>{w=performance.now()},monitoringEnd:()=>{let E=performance.now(),O=E-w;m+=O,v++,L=m/v,u=Math.max(u,O),s=Math.min(s,O);for(let N of S)E-T>N.refreshInterval&&((async()=>N.cb(o,performance.timeOrigin+E,L,s,u,v,m))(),T=E,m=0,v=0,L=0,s=Number.MAX_VALUE,u=Number.MIN_VALUE)}}}callbacks=[];onPerfLog(o,s){return this.callbacks.push({refreshInterval:o,cb:s}),this.enablePerfLog(!0),()=>{this.callbacks=this.callbacks.filter(u=>u.cb!==s)}}enablePerfLog(o){}};U=b([He()],U);var le=class{getModule(){return new Xe(o=>{o(I).to(A).inSingletonScope(),o(x).to(U).inSingletonScope(),o(ae).to(P).inSingletonScope(),o(se).to(R).inSingletonScope(),o(ie).to(F).inSingletonScope()})}};export{q as AnimationFrameLoop,P as AnimationFrameLoopFactory,ae as AnimationFrameLoopFactoryName,le as AxLoopModule,A as FrameLoopManager,I as FrameLoopManagerName,U as LoopTimeLogger,x as LoopTimeLoggerName,lt as SUFFIX_DELIMITER,H as SetIntervalLoop,F as SetIntervalLoopFactory,ie as SetIntervalLoopFactoryName,X as SetTimeoutLoop,R as SetTimeoutLoopFactory,se as SetTimeoutLoopFactoryName};
/*! Bundled license information:

reflect-metadata/Reflect.js:
  (*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** *)
*/
//# sourceMappingURL=index.js.map